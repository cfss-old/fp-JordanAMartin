---
title: "TITLE"
author: "Jordan Martin"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    code_folding: show
    collapsed: false
---

```{r Load Libraries, cache=FALSE, include=FALSE}
library(tidyverse)
library(gridExtra)
library(stats)
library(pander)
```

## Method

#### Eye-tracking Paradigm

Eighteen-month-old infants were shown an eye-tracking paradigm... 
  
Familiarization videos showed an agent reaching for and grasping one of two toys. Four different agents and toy-pairs were shown. Test trials were shown twice, each after familiarization, for a total of 8 Test Trials.

#### Data Reduction

[Data Reduction](Tidying.html).


```{r Load Data, echo=TRUE, message=FALSE, warning=FALSE}
MOAP <- read_csv("data/MOAP.csv")
# Fix pesky `` issue
names(MOAP)[1] <- "Test"
# Drop NA rows
MOAP <- drop_na(MOAP, Hand_Prediction, Body_Prediction)
```

#### Exclusions

A total of 12 infants were excluded from analysis do to low calibration (n = 4), fussiness (n = 2), and sample rate < 50% (n = 6).

```{r Exclusions, echo=TRUE, message=FALSE, warning=FALSE}
MOAP <- MOAP %>%
  filter(ID != "M08" & ID != "M11" & ID != "M14" & ID != "M17" & ID != "M18" & ID != "M25" & ID != "M26" & ID != "M27" & ID != "M30" & ID != "M31"  & ID != "M32"  & ID != "M33")
```

#### Q1: Does varying initial fixation AOI from hand to body change prediction response?

```{r Prediction Proportions, echo=TRUE, message=FALSE, warning=FALSE}
# Graph Proportion of Predictions for each initial AOI
Hand_Pred <- ggplot(MOAP) +
  geom_bar(mapping = aes(x = Hand_Prediction, y = ..prop.., group = 1)) +
  labs(x = "Prediction", y = "Proportion of Predictive Fixations")
Body_Pred <- ggplot(MOAP) +
  geom_bar(mapping = aes(x = Body_Prediction, y = ..prop.., group = 1)) +
  labs(x = "Prediction", y = "Proportion of Predictive Fixations")
grid.arrange(Hand_Pred, Body_Pred, nrow=1)
```

The next analysis will examine infantsâ€™ predictive fixations to either the prior goal or prior location object across test trials for the two AOI definitions. Planned comparisons against chance (.5) revealed that when using the Body definition, infants launched predictive fixations systematically to the prior goal (M=__, SD=__, t(__)=__, p = __), whereas when using the Hand definition, infants responded at chance levels (M=0.48, SD=__, t(__)=__, p = __).

```{r }
# Recode Predictions

HP <- MOAP %>%
  filter(Hand_Prediction != "No Prediction")%>%
  select(ID, Trial_Num, Hand_Prediction, Hand_Latency, FamTrialLength_ms, Fam_Screen)%>%
  na.omit()%>%
  mutate(Prediction = ifelse(Hand_Prediction == "Distracter", 0, 1))%>%
  group_by(ID)
df <- tibble(mean(HP$Prediction), sd(HP$Prediction))
colnames(df)[1] <- "Mean"
colnames(df)[2] <- "SD"
output <- t.test(HP$Prediction, mu=.5)
pander(df)
pander(output)

BP <- MOAP %>%
  filter(Body_Prediction != "No Prediction")%>%
  select(ID, Trial_Num, Body_Prediction, Body_Latency, FamTrialLength_ms, Fam_Screen)%>%
  na.omit()%>%
  mutate(Prediction = ifelse(Body_Prediction == "Distracter", 0, 1))%>%
  group_by(ID)
df1 <- tibble(mean(BP$Prediction), sd(BP$Prediction))
colnames(df1)[1] <- "Mean"
colnames(df1)[2] <- "SD"
pander(df1)
output1 <- t.test(BP$Prediction, mu=.5)
pander(output1)
```


```{r Fam Attention, eval=FALSE, include=FALSE}


# Calculate Sample Rate: Divide AOI Attention by Trial Length, drop trial length variables
transform(MOAP, Fam_Screen_Att = Fam_Screen / FamTrialLength_ms)
```

```{r, include=FALSE}
# library(DT)
# datatable(x)
```


